-- SQL: simple blog schema + sample queries (PostgreSQL-compatible)

BEGIN;

CREATE TABLE Materiel (
    id_Materiel INT AUTO_INCREMENT PRIMARY KEY,
    nom_materiel VARCHAR(100) NOT NULL,
    description_materiel TEXT,
    type_materiel VARCHAR(50),
    stock_total INT NOT NULL DEFAULT 0,
    stock_disponible INT NOT NULL DEFAULT 0,
    Empruntable BOOLEAN NOT NULL DEFAULT TRUE
);

CREATE TABLE Admin (
    id_admin INT AUTO_INCREMENT PRIMARY KEY,
    email_admin VARCHAR(100) NOT NULL UNIQUE,
    hash_admin VARCHAR(255) NOT NULL
);

CREATE TABLE Emprunt (
    id_emprunt INT AUTO_INCREMENT PRIMARY KEY,
    motif_emprunt TEXT,
    email_emprunt VARCHAR(100) NOT NULL
);

CREATE TABLE Emprunter (
    id_emprunt INT,
    id_Materiel INT,
    id_Admin INT,
    date_emprunt DATE,
    date_retour_prevue DATE,
    date_retour_reelle DATE NULL,
    statut_emprunt VARCHAR(50) NOT NULL DEFAULT 'en cours',
    PRIMARY KEY (id_emprunt, id_Materiel),
    FOREIGN KEY (id_emprunt) REFERENCES Emprunt(id_emprunt),
    FOREIGN KEY (id_Materiel) REFERENCES Materiel(id_Materiel),
    FOREIGN KEY (id_Admin) REFERENCES Admin(id_admin)
    );